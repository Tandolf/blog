<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Gatsby Starter Blog RSS Feed]]></title><description><![CDATA[A starter blog demonstrating what Gatsby can do.]]></description><link>https://blog.toerktumlare.com</link><generator>GatsbyJS</generator><lastBuildDate>Mon, 24 Oct 2022 18:38:51 GMT</lastBuildDate><item><title><![CDATA[Implementing base64 in rust]]></title><description><![CDATA[I have a confession to make. Please don’t think any less of me, but i have never really understood how Base64 actually works. I know what it…]]></description><link>https://blog.toerktumlare.com/base64-in-rust/</link><guid isPermaLink="false">https://blog.toerktumlare.com/base64-in-rust/</guid><pubDate>Sat, 10 Sep 2022 21:08:00 GMT</pubDate><content:encoded>&lt;p&gt;I have a confession to make. Please don’t think any less of me, but i have never really understood how Base64 &lt;em&gt;actually&lt;/em&gt; works. I know what it is used for. I know when to use it and I have a vague understanding of how it is implemented, but i have never &lt;strong&gt;fully&lt;/strong&gt; understood it. Until now.&lt;/p&gt;
&lt;p&gt;I was looking at new things to implement and i stumbled across the &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc4648&quot;&gt;rfc for Base64&lt;/a&gt; and thought to myself. &lt;em&gt;Maybe I can implement this, in rust&lt;/em&gt;. So i sat down and read &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc4648&quot;&gt;rfc 4648&lt;/a&gt; and started to understand how it actually works. I then googled a bit and looked at other implementations.&lt;/p&gt;
&lt;p&gt;So in this post im going to try to explain what base64 is, a bit of how it works, and then we are going to implement a simple encoder and decoder.&lt;/p&gt;
&lt;h2&gt;What is it used for?&lt;/h2&gt;
&lt;p&gt;Lets look at how &lt;a href=&quot;https://en.wikipedia.org/wiki/Base64&quot;&gt;wikipedia&lt;/a&gt; describes base64.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Base64 is designed to carry data stored in binary formats across channels that only reliably support text content.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When we send information on the internet all servers can’t accept all formats of data. But one thing in common is that most servers can accept data in the form of text. This is where base64 comes into play. If a server can’t accept a certain format, we can always send the data as a textual representation of the data, then the server can accept the text and convert it into whatever format it needs to be on its and.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Important, Base64 is NOT encryption, its an encoding schema. We convert it to something and have the ability to convert 
it back. Don&apos;t ever use Base64 on passwords etc. and think it will protect you, anyone can decode Base64.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;On the world wide web, base64 is very common to use when wanting to send send files like images and and css files using base64 as a textual representation of the data instead of sending the data itself. For instance you commonly use it when you want send email attachments and this is because the original SMTP protocol only supported &lt;a href=&quot;https://en.wikipedia.org/wiki/ASCII&quot;&gt;7-bit ascii&lt;/a&gt; so there was a need to be able to represent data as text when sending emails.&lt;/p&gt;
&lt;p&gt;Image below shows how base64 could be used when sending an image from one server to another server.&lt;/p&gt;
&lt;div class=&quot;mermaid&quot;&gt;graph LR
    A(&quot;image -&gt; base64(image)&quot;)-- encoded-data --&gt;B(&quot;base64(image) -&gt; image&quot;)&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;We encode our data into base64, a textual representation of the data.&lt;/li&gt;
&lt;li&gt;We send that data to a receiving server or client&lt;/li&gt;
&lt;li&gt;The server/client decodes the base64 encoded data and recreates the original data on the other side.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;So what is base64 actually?&lt;/h2&gt;
&lt;p&gt;On the internet there is a saying which goes as follows, &lt;em&gt;“there is no such thing as plain text”&lt;/em&gt;. which is completely true. In the computer world all text is represented by 0 and 1’s. But if we have a series of bits then what text it represents depends on how we look at the bits. 3 bytes, represent 24 bits, (1 byte = 8 bits). But we can also think of 24 bits as 4 groups of 6 bits.&lt;/p&gt;
&lt;p&gt;Here i’ll show you a visual representation taken straight out of the rfc which shows what im talking about.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;+--first octet--+-second octet--+--third octet--+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+-----------+---+-------+-------+---+-----------+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+--1.index--+--2.index--+--3.index--+--4.index--+&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see here is that depending on how you decide to create your groups you can represent 24 bits as either 3 groups of 8 bits, or 4 groups of 6 bits. And this is the entire basics of the encoding and decoding using the base64 system.&lt;/p&gt;
&lt;p&gt;You see 8 bits can represent 256 different numbers. While 6 bits can only represent 64. This means that if we take any binary representation of text and instead look at it as in groups of 6 bits. And then map these 64 numbers to a given set of letters. We suddenly have a way of encoding any data into a limited textual representation. This can then be sent to someone that maybe only can receive limited character set, to later be converted back into something more elaborate like for instance the russian or chinese alphabet.&lt;/p&gt;
&lt;p&gt;So what letters are we representing with our limited set of 64 numbers?&lt;/p&gt;
&lt;p&gt;The rfc show us just that.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;                    The Base &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt; Alphabet

 Value Encoding  Value Encoding  Value Encoding  Value Encoding
         &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; A            &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt; R            &lt;span class=&quot;token number&quot;&gt;34&lt;/span&gt; i            &lt;span class=&quot;token number&quot;&gt;51&lt;/span&gt; z
         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; B            &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt; S            &lt;span class=&quot;token number&quot;&gt;35&lt;/span&gt; j            &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; C            &lt;span class=&quot;token number&quot;&gt;19&lt;/span&gt; T            &lt;span class=&quot;token number&quot;&gt;36&lt;/span&gt; k            &lt;span class=&quot;token number&quot;&gt;53&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; D            &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt; U            &lt;span class=&quot;token number&quot;&gt;37&lt;/span&gt; l            &lt;span class=&quot;token number&quot;&gt;54&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; E            &lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt; V            &lt;span class=&quot;token number&quot;&gt;38&lt;/span&gt; m            &lt;span class=&quot;token number&quot;&gt;55&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; F            &lt;span class=&quot;token number&quot;&gt;22&lt;/span&gt; W            &lt;span class=&quot;token number&quot;&gt;39&lt;/span&gt; n            &lt;span class=&quot;token number&quot;&gt;56&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; G            &lt;span class=&quot;token number&quot;&gt;23&lt;/span&gt; X            &lt;span class=&quot;token number&quot;&gt;40&lt;/span&gt; o            &lt;span class=&quot;token number&quot;&gt;57&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; H            &lt;span class=&quot;token number&quot;&gt;24&lt;/span&gt; Y            &lt;span class=&quot;token number&quot;&gt;41&lt;/span&gt; p            &lt;span class=&quot;token number&quot;&gt;58&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; I            &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt; Z            &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt; q            &lt;span class=&quot;token number&quot;&gt;59&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;
         &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt; J            &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; a            &lt;span class=&quot;token number&quot;&gt;43&lt;/span&gt; r            &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; K            &lt;span class=&quot;token number&quot;&gt;27&lt;/span&gt; b            &lt;span class=&quot;token number&quot;&gt;44&lt;/span&gt; s            &lt;span class=&quot;token number&quot;&gt;61&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt; L            &lt;span class=&quot;token number&quot;&gt;28&lt;/span&gt; c            &lt;span class=&quot;token number&quot;&gt;45&lt;/span&gt; t            &lt;span class=&quot;token number&quot;&gt;62&lt;/span&gt; +
        &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt; M            &lt;span class=&quot;token number&quot;&gt;29&lt;/span&gt; d            &lt;span class=&quot;token number&quot;&gt;46&lt;/span&gt; u            &lt;span class=&quot;token number&quot;&gt;63&lt;/span&gt; /
        &lt;span class=&quot;token number&quot;&gt;13&lt;/span&gt; N            &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; e            &lt;span class=&quot;token number&quot;&gt;47&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;v&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt; O            &lt;span class=&quot;token number&quot;&gt;31&lt;/span&gt; f            &lt;span class=&quot;token number&quot;&gt;48&lt;/span&gt; w         &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pad&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt; P            &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt; g            &lt;span class=&quot;token number&quot;&gt;49&lt;/span&gt; x
        &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt; Q            &lt;span class=&quot;token number&quot;&gt;33&lt;/span&gt; h            &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here we can see the defined base64 alphabet. So by mapping each group of 6 bits to a number between 0-64 (using binary to real number conversion) we can then select the correct letter and in the end encode our data with a limited text range.&lt;/p&gt;
&lt;h2&gt;Padding&lt;/h2&gt;
&lt;p&gt;You can often spot a base64 string because its very common that the a base64 text representation ends with one or two equal signs (=). You see that in order for us to convert something we need to bits to line up.&lt;/p&gt;
&lt;p&gt;Data that isn’t suitable for conversion.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;+--first octet--+-second octet--+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+-----------+---+-------+-------+---+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+--1.index--+--2.index--+--3.index--+&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here you can see that the data provided can’t really be converted since it it doesn’t evenly add up, so in these cases we often need to pad out the data by adding padding data. We usually add one or many &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; values to pad out. This padding will in the textual representation be shown as a &lt;code class=&quot;language-text&quot;&gt;=&lt;/code&gt; character.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;+--first octet--+-second octet--+--third octet--+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; P A D D I N G &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+-----------+---+-------+-------+---+-----------+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+--1.index--+--2.index--+--3.index--+--4.index--+&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So in the above example we added a single padding character to the end of the data so that the conversion in the end adds up evenly. The padding character in the base64 alphabet is represented by an &lt;em&gt;equal sign&lt;/em&gt; and at most you need 2 equal signs in the and, which gives a base64 encoded string its classic look of a text string ending with up to 2 equal signs.&lt;/p&gt;
&lt;p&gt;Some examples of strings that needed to be padded to be fit for encoding, notice the different amount of equal signs at the end.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;BASE64&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;foob&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Zm9vYg==&quot;&lt;/span&gt;

BASE64&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;fooba&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Zm9vYmE=&quot;&lt;/span&gt;

BASE64&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;foobar&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Zm9vYmFy&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here is an example of how we solve this problem in code.&lt;/p&gt;
&lt;p&gt;Below We check that the supplied data bytes are devisable by 3, if not we add the corresponding padding (1 or 2) &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; characters to the end of the supplied data, so that we can encode the data properly. Then at the end, of this code snippet, we remove the added padding and replace it with proper equal signs to show that we have padded our data.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// check if we need to add padding or not&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; input_length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;mut&lt;/span&gt; padding&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; input_length &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; _ &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; input_length&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        padding&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token char&quot;&gt;&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// add null values to pad out the data&lt;/span&gt;
        input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token char&quot;&gt;&apos;\0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Code for encoding the data, omitted for abbr.&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// strip the null values after encoding&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;mut&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;result_length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// add on the correct number of equal signs to the and of the encoded string&lt;/span&gt;
result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;padding&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Lets write an encoder&lt;/h2&gt;
&lt;p&gt;To encode some data into base 64, we are going to split this up into 4 different steps. I will explain the steps as we go, but we will start out by creating a loop that will extract out 3 bytes at a time in a loop. Because as we explained earlier, we want to convert 3 groups of 8 bits, into 4 groups of 6 bytes.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; value_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;as_bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; value_iter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;step_by&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; value_iter &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; char_number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; char_number1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; char_number2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number1 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number2 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Most of the code above is easy to understand except for maybe the last line. What we do in that last line is that we get the first 3 bytes, we then cast and bit shift each byte into its own “space” in a u32 representation.&lt;/p&gt;
&lt;p&gt;Lastly we add them all together, so they all fit together nicely in their own space. The below representation shows how it works visually.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;// We extract a byte (for example FF which is hex value of the numeric value 255)
1111 1111

// we then cast the value to a u32 (32bits) so we get some free space
0000 0000 0000 0000 0000 0000 1111 1111

// then we shift the value 16 steps to the left
0000 0000 1111 1111 0000 0000 0000 0000

// We do the same with the second value but only shift it 8 bits
0000 0000 0000 0000 1111 1111 0000 0000

// the last value we only cast to a u32 (32 bits)
0000 0000 0000 0000 0000 0000 1111 1111

// we then add them all together and each byte gets their own space
0000 0000 1111 1111 1111 1111 1111 1111&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So now we have a 32 bit representation of our 3 first bytes. Time to do the conversion, and we do it by doing some more bit shifting.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number1 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;char_number2 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3F&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3F&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;n &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3F&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0x3F&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To extract our 4, 6-bit numbers from our 32-bit number we need to do some more bit shifting. The above code does this, but if you read below the steps are explained but using the bit representations to show it more graphically.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;// We start out with our newly created &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt; bit number
0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // We &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt; bit &lt;span class=&quot;token builtin class-name&quot;&gt;shift&lt;/span&gt; it down &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt; steps and mask off everything above the 6th bit
   0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // second value is created by a &lt;span class=&quot;token builtin class-name&quot;&gt;shift&lt;/span&gt; by &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt; steps down and masked the same way
   0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // third we instead bit &lt;span class=&quot;token builtin class-name&quot;&gt;shift&lt;/span&gt; by &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; and mask off
   0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // And finally we don&apos;t &lt;span class=&quot;token function&quot;&gt;touch&lt;/span&gt; the original value but mask it to get the last value
   0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 0011 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now that we have our 4 new values, we can do a simple lookup table check to see what letter our new values represents and create as new string from it.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token char&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;B&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;C&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;D&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;E&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;F&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;G&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;H&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;I&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;J&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;K&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;L&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;M&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;N&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;O&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;P&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;Q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;R&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;S&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token char&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;U&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;V&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;W&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;X&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;Y&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;Z&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;d&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;e&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;f&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;g&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;h&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;i&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;j&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;k&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;l&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token char&quot;&gt;&apos;m&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;o&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;p&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;q&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;r&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;s&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;t&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;u&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;v&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;x&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;y&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;z&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;3&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;4&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token char&quot;&gt;&apos;5&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;6&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;7&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;9&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;+&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token char&quot;&gt;&apos;/&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;n1 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;n2 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;n3 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;n4 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;usize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c3&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c4&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;And then a Decoder&lt;/h2&gt;
&lt;p&gt;To decode, we basically just need to remove the padding, and then do the entire process but in reverse. One thing to remember is that before the decoder process can be run you will probably want to do some validation to make sure that what you are about to decode is a proper base64 string. I wont show that code here, but doing a regexp check that it includes only the allowed characters from the base64 alphabet will usually suffice.&lt;/p&gt;
&lt;p&gt;So we start out by stripping off the padding, and replacing the equal signs with something else. Anything will work.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; suffix &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ends_with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;==&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;AA&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ends_with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token char&quot;&gt;&apos;=&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;A&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// remove the equal signs&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;mut&lt;/span&gt; input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; suffix&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;to_string&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// push new characters on the end if needed&lt;/span&gt;
input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;suffix&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After the padding has been replaced, we enumerate, but this time 4 bytes at a time (instead of 3 like we did during the encoding process). We then get the value of each of the bytes and check their indexes in our array of Base64 characters that we used earlier.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; value_bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;as_bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;mut&lt;/span&gt; bytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; input_iter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;step_by&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; input_iter &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; v &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;index_of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; v1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;index_of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; v2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;index_of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; v3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;index_of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value_bytes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;fn&lt;/span&gt; &lt;span class=&quot;token function-definition function&quot;&gt;index_of&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;-&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;usize&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;BASE64_CHARS&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token closure-params&quot;&gt;&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;c&lt;span class=&quot;token closure-punctuation punctuation&quot;&gt;|&lt;/span&gt;&lt;/span&gt; c &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;unwrap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Like before, we bit shift and mask, but this time we do it a little bit different because we want to go from 4 bytes, to 3 bytes per group.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; n&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;v &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;v1 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;v2 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;v3 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This time though, we need to shift things a little bit differently.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;// We extract a byte but this has only 6 bits in a 8 bit space
0011 1111

// we then cast the alphabetic value to a u32 (32bits)
0000 0000 0000 0000 0000 0000 0011 1111

// then we shift the value 18 steps to the left
0000 0000 1111 1100 0000 0000 0000 0000

// We do the same with the second value but only shift it 12 bits
0000 0000 0000 0011 1111 1100 0000 0000

// the 3rd is shifted 6 bits
0000 0000 0000 0000 0000 1111 1100 0000

// And the 4th is not shifted at all
0000 0000 0000 0000 0000 0000 0011 1111

// we then add them all together and each byte gets their own space
0000 0000 1111 1111 1111 1111 1111 1111&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After the extraction of the data, we need to shift the bits a little bit more to create our 3 groups of 8 bits that we can store in a proper byte array. That is done in the following way.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;// We start out with our newly created &lt;span class=&quot;token number&quot;&gt;32&lt;/span&gt; bit number
0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // We &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt; bit &lt;span class=&quot;token builtin class-name&quot;&gt;shift&lt;/span&gt; it down &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt; steps and mask off everything above the 8th bit
   0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // second value is created by a &lt;span class=&quot;token builtin class-name&quot;&gt;shift&lt;/span&gt; by &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; steps down and masked the same way
   0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;

   // third we dont shift, we just mask off
   0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;  0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;
------------------------------------------
   0000 0000 0000 0000 0000 0000 &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1111&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All of the operations above are done with the following code. And then we just push the decoded bytes onto a new list of &lt;code class=&quot;language-text&quot;&gt;bytes&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; c2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; n &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0xFF&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

bytes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
bytes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c1 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
bytes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c2 &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;u8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Before we can convert this to a proper string we lastly need to remove the characters we used for padding, and then we convert the entire string to a utf-8 string that we can return.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;rust&quot;&gt;&lt;pre class=&quot;language-rust&quot;&gt;&lt;code class=&quot;language-rust&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// remove padding characters&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; _ &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;suffix&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    bytes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// create a utf-8 string from the provided data&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; output &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;from_utf8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;unwrap&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And thats it!&lt;/p&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;So in this post we have looked closer at what base64 is and what it is used for. We also looked at how to implement our own version of a base64 encoder and decoder. There are probably many more different ways and more efficient ways you can implement this to be more effective, but i found this to be fun and a learning experience. The entire code with a working example can be found on my &lt;a href=&quot;https://github.com/Tandolf/base64&quot;&gt;github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Until next time, have a nice one.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[What was CVE 2020–0601 aka. Curveball?]]></title><description><![CDATA[Monday the 13th of January Brian Krebs published on his blog that he had sources telling him that the day after, Microsoft would release…]]></description><link>https://blog.toerktumlare.com/cve-2020-0601/</link><guid isPermaLink="false">https://blog.toerktumlare.com/cve-2020-0601/</guid><pubDate>Thu, 30 Jan 2020 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;Monday the 13th of January Brian Krebs published on his blog that he had sources telling him that the day after, Microsoft would release software updates that would fix a vulnerability in the Windows Crypto API.&lt;/p&gt;
&lt;p&gt;And indeed, the day after on the 14th of January, NSA released a cybersecurity advisory that disclosed a vulnerability in the crypto API. This vulnerability allowed an attacker to defeat the certificate validation in Windows 10 and it would affect TLS, code signing etc.&lt;/p&gt;
&lt;p&gt;Less than 24 hours later, security researcher Salim Rashid published a proof of concept on his twitter account showing that he successfully “rick rolled” github.com and nsa.gov using a custom-made CA certificate.&lt;/p&gt;
&lt;blockquote class=&quot;twitter-tweet&quot; data-theme=&quot;dark&quot;&gt;&lt;p lang=&quot;und&quot; dir=&quot;ltr&quot;&gt;CVE-2020-0601 &lt;a href=&quot;https://t.co/8tJsJqvnHj&quot;&gt;pic.twitter.com/8tJsJqvnHj&lt;/a&gt;&lt;/p&gt;&amp;mdash; ✨saleem✨ ⍼ (@saleemrash1d) &lt;a href=&quot;https://twitter.com/saleemrash1d/status/1217495681230954506?ref_src=twsrc%5Etfw&quot;&gt;January 15, 2020&lt;/a&gt;&lt;/blockquote&gt; &lt;script async src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; 
&lt;p&gt;Shortly after this, Ollypwn aka. Oliver Lyak, a security researcher from Denmark, published a proof of concept exploit on GitHub for anyone to use. And what struck the world was that the exploit consisted of less than 10 rows of code and anyone could do it.&lt;/p&gt;
&lt;p&gt;For the rest of this blog post I’m going to try to explain how this vulnerability works on a very high level, and point out why this exploit is extremely powerful.&lt;/p&gt;
&lt;h2&gt;CA Certificates&lt;/h2&gt;
&lt;p&gt;Let’s start by looking at what a basic CA Certificate consists of. These types of certificates are used to sign other certificates, as a form of trust. You have a certificate and you let a well-known certificate authority (CA) sign your certificate. By signing, they sort of “vouch” that you are who you claim to be.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.632911392405056%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVQoz32SPWvCQBiA/TtCRZohJEOge3cHJ5dOzhU6OTu23Tq5dpGMKQQc2i2D4CBaGrzEnOTM3cWk5ktIrphDo6X0GY7jvXt4P+5qrKQoCnbkfP8/tdNtSqlhGJvN5txPkiQMwyRJvkvSNL2Q8zxnjI3HY0VRRFGUJGk0GjHGeBwhNJvNIISmaVqWhRCK4zjLsipzEASKorTbbV3Xu92uIAi2teTHhBCnZL1e+75vl3ieV8mTyaRer/f7/eFwOBgMrq4a2pvOkwdBQAiBEG63W7cEY0wIqWSMsSzLrVar1+t1Oh3hujl9f2bpFy/bsqzVaoUQchzHLJnP51EUHWQ+G1VVZVluNhuidPPydB8at/70gRUZoT43uex5Hu9/t9tdTBuApaZpi8U8/Xykxl0EXnlRtm1jjF3XBQAQQnzfJ4TwmdWqty0O492jj3ip8hhjjLdKKYUQAgAwxr/f+eTneVHke64d1z84/YIfBeEM8hiDlAQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Certificate example&quot;
        title=&quot;Certificate example&quot;
        src=&quot;/static/56ffd11d3c490037a2e4fde6ae7ecd48/f058b/cert-example.png&quot;
        srcset=&quot;/static/56ffd11d3c490037a2e4fde6ae7ecd48/c26ae/cert-example.png 158w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/6bdcf/cert-example.png 315w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/f058b/cert-example.png 630w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/37523/cert-example.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;A typical CA certificate contains information such as the subject (who issued it), for how long it is valid, a key usage (what the key is used for), a public key and a declaration of what type of algorithm that is used in the CA certificate.&lt;/p&gt;
&lt;p&gt;Two of the most common types of algorithms used are Elliptic Curve and RSA. &lt;strong&gt;It’s important to know that CVE 2020–0601 aka. Curveball only affects Elliptic Curve certificates. RSA type CA certificates are unaffected.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Elliptic curve is a mathematical concept used in cryptology. &lt;a href=&quot;https://www.secg.org/SEC2-Ver-1.0.pdf&quot;&gt;There are many different types of mathematical curves&lt;/a&gt; that can be used when using Elliptic curve cryptography so each elliptic curve certificate must include what type of curve that was used in the specified certificate.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 87.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQUlEQVQ4y3WTe3OqMBTE+/0/2Z22WrW2PkhyTggQ5RWlkvAIcAdi1c7t3Rn+/M1udg9Pl8slCAIxiTF2PB6jKBJCBJPiOP76+hr+UVVVwzA8aa2llPv9HgB2ux0ico6EUgZIKOOcHw6Hpmnatu2+1ff9FbbWFkUhpZywUR4hApj/+cHX73EYxEmaZZnWuus6a63jtdYj7DLkeS6lpJMYIt9u8GMtCWmLczcMztZOcs51XV+dT6dTGIacc0T0OaeMhYh89gwvf6QQxzhOkqQsy0dnY8zVua5rx1NKCSGEMtxu2Md7sN/1unQNPTrfY3dd50jf9wGAI1LGAgRcLWAxP4ZhnCRZmj6++V7YMAxa6zRNwzBkjAEAQxTEw/UK35dlluqqMlo3TfPf2HmeR1E0xfYoAO42bPMZUO87dt/3/SPsxh8LO5/PURRxzhljiEgIFcD46o3OXw9BECdJOsXu+/6XqYwxSqkoihARAAC58Ha4XorPdX1SjbVt0zjsBl8ul2thztn3fUopABBKfULY2wyX81RGuVJ5nhtjfok9DENZlmmaBkEwwoxNsAeLOXubXfJsLMyYuq5va1lrr843WErJJlEAQTxYr8R2Y06qapqqqh6PzFp7dXYZbg8eC6NUMIrLuff6HIdBkmaPsX/A7raVUvfbBvD3O7ZajIWdT421TVPfCvsBW2uVUmEYIqIrbO8RQQnMXtjs+SD8eFzqPpVTURRX57ZtjTFFUWRZlo9fro6HdL9VQPu6ut32o9xf9Rcyye585QrAZwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Example curves defined in the “Standards For Efficient Cryptography”&quot;
        title=&quot;Example curves defined in the “Standards For Efficient Cryptography”&quot;
        src=&quot;/static/e6e7a66e5f6e5a550408fc237fb2b382/f058b/example-curves.png&quot;
        srcset=&quot;/static/e6e7a66e5f6e5a550408fc237fb2b382/c26ae/example-curves.png 158w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/6bdcf/example-curves.png 315w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/f058b/example-curves.png 630w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/40601/example-curves.png 945w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/78612/example-curves.png 1260w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/07d7d/example-curves.png 1478w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Each curve is made up a series of parameters called p, a, b, G etc. and by declaring that we want a predefined curve like secp256r1, these values (p, a, b, G) will be set for us automatically, and our certificate will use that specified curve.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAESklEQVQ4y4VV208cVRz+zVKpcr8vLFYEloWdMwMKiSG10tQuy54DmGJpcaUVand3ZvZy5rLLNSlpWq2JRpOWl7ahNUaJ9QXZPUMpFaOJD9r4om8++9o/AjOX3dLE6Em+ZHLmzDe/75zv9x2A/xiyqnOSqoOk6p0S1dokqoEFAReAJybwhHE8YYAwa0WEtSDCnicQcQFEnIf+yDYgYkJU+phLGQYkjZxPonq9rBqQoLrzHltEBQtlCDNRwHnOmrOHP3LTXeAgSHYAkR3wvvUEUkYOZG3ZK1GjWlazEM9k7Z/xxOScKs0AT1iT++wQHiZDrhxEdioGJrerYuoKXL06V5/U1Jr1T0Mwp6wCIoxD9hrmRYT1WLKLP3AII3mbjLerMz0Is16BmAFxnPX0hPf84dnbQx8kV2tPnr8PvpEn4JDtVCNiisF39p99b+3h0NjWof2wq0QIF5qsj/yjPwLAATc6e0ccntocDoT3fAMT+RedAzBFkbAywToU8kwhtJ/5xT41l7AFYdZhvySm53T0nueCcg3W1i41xNO52u7QfrNIWB8i7NU+vM2hIpkLeyg0DSemv/IE8UMQCOsVxwsVPeF9wLProOg5Lp3NgqwttSqaWnNqZsOuui+yCxB8CiPn7sM366J9UJadEhkVIK0rMKesWNIgGNntgpoDbib2EaT1FCQyFBQ9C6nsQnOCGlXGQgIO/gC4+/kwpPU0SFQHWdVslAhjaeOonovVnY7ebXhj6jvh0UbTkfnkcoVMtZdkVa9IpOkLST3bIVHdK1O13J7/F0hUa0xk1DKIZ/T6lJYKno/dCISid0YWl+bb4plch6zqr9igmk/RjEFZ1XlZ1dpL88/jmEQ1IZ5Rj0JSS8F8chkODgACoz90Pt5sgvnkCiQ1astQNMOS3JigRkVSUyG7GAM9J4FiS9VLsNbGLckSpUAu3vR0hn6GflLoG5zcqix77W+4KF/hFM3gUtkFUPTF1svphbrR929D1dBf0PLm7zCXXOVm4te5jJGy9pKTqMbFMxTA++5vtm0c6zAvwuyYYwPTE4pueJZWZVhcUZqurU1X1A7/WT5AtptFXGjgsQm8613esZljm8HIlt1qXZOm2wGmyBOz0nruDu3DxNwtOHPpi+7jZ78e6h3bDYiEtQuYdSLM+MDY9xxfJMTMLsrt5WIc7QA//rCcJ6aACPOL4wV/ILznP/XeveP4wi2f5cNA+LGzHhcaecIEHuehHW8Cwiag8WIvO81dIhUj21w/zle/PrFVDb1Pj1xZ+7BhaXm+8pPrU3Dy3JdWTHFuN/kQYV1uUHClbmme/smpziUVI3k7G1tP/ApnL38GkrbcGs9ka2TNyUPeCQMncTALIsJqS71cHMNvP7ArDbrE/TgP0cQNjuZUK2DbJKrXFQNWwA8OR145wkwQyCPoHfsW4P+uANdnfolq7cUroJhMAi5wrkNeFjGrt1T9AziN0F6XhB1LAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;example curve&quot;
        title=&quot;example curve&quot;
        src=&quot;/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png&quot;
        srcset=&quot;/static/ba395866b6facbfd04e1490275a99d60/c26ae/curve.png 158w,
/static/ba395866b6facbfd04e1490275a99d60/6bdcf/curve.png 315w,
/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png 400w&quot;
        sizes=&quot;(max-width: 400px) 100vw, 400px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Sometimes you want to use a custom curve or a “not yet implemented” curve and to do so you can include all the needed parameters in the CA Certificate directly instead of defining a predefined curve.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Curve: parameters p/a/b/G&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When Microsoft implemented the functionality, that you can supply your own parameters to represent an elliptic curve, that’s when the vulnerability CVE 2020–0601 got introduced into Windows 10.&lt;/p&gt;
&lt;h2&gt;Certificate Usages&lt;/h2&gt;
&lt;p&gt;Before we can investigate how to exploit CVE 2020–0601, we need to first talk a little about how certificates are used in the real world. We are going to look at one way of using certificates to enforce trust, and that is when requesting websites.&lt;/p&gt;
&lt;p&gt;Windows 10 provides a library applications can use to verify certificates. This library is called crypt32.dll and it is here the vulnerability was discovered. Any windows application — such as web browsers, file transfer tools or email clients — that rely on this library, to verify cryptographic signatures, may be affected by CVE 2020–0601.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQY05WQvUrEUBBG97l8A1/A0lbEIIKFsIXVguAWusUaItYrCCI2gqAL2yxICkmpLhKNYmCTu+bn5uZO7sxoNKCFoJ5qmvPNzNfiD4gZkIj/R2taGPs67Yxf14cCzJf+PQhnAu/vdJZWiKA1ADTyrYCF0+nSebQ2FJkslCq0rvJMhI+uUmWpVIEUb23K+bnxzvbB4HDfth3H8TyvlkNpuldJeyRWL+MSDCEiEhowkNWjMcgMkxsYXcjw5SEInoLAdV3f92v580JVkVCIPz5NlHXayfKifvbTQsVRtGJZe/1+I/8GqeOjpGvJyUlpWOZ5r7d7NthgVq0/FkusiZueyGiuZu+b3wDDV4K694c+3AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;handshake example&quot;
        title=&quot;handshake example&quot;
        src=&quot;/static/f84145a9243c23753f3ee3f081b79109/f058b/yt1.png&quot;
        srcset=&quot;/static/f84145a9243c23753f3ee3f081b79109/c26ae/yt1.png 158w,
/static/f84145a9243c23753f3ee3f081b79109/6bdcf/yt1.png 315w,
/static/f84145a9243c23753f3ee3f081b79109/f058b/yt1.png 630w,
/static/f84145a9243c23753f3ee3f081b79109/37523/yt1.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;A majority of trusted sites on the internet have their own signed certificate. This is used to verify that, when we request something on the internet, we get it from the actual place we requested it from. It’s to prevent things like man-in-the-middle attacks, fake websites etc.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 42.405063291139236%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQY052Oy0rDQBSG80I+gY/gRhTcunIjLhW68RW6ryiIi4pQInbjBSxiSSBiFCwILWiKiNBcTjKdJpnLmRmJBV3YIvgtzuLA9/+/lTJ1FRSHPbr/RLWZA6KW8vfbehzxtXa4cRHvdjPBOWcMURP4SONAohZSFpRmO5tkffX61LbP2sfNpm3bAFDJAxDbnWTrMqzdgJSVzoXMx3E5GQmJQgpWlkW7xU+Ohv2+47qe5zmOQwipZKV1ynVQmgFRWs8dPhOrOpyZtxdDs6kaRdG9/4D4HaSNQqNQqx+mNZXMup1wcYHUaxFNcjppNPZWlpeee3eEUABI0xQAKKWzm/WYcPc29w8QM2PM6/D9vFVnif/Vqv6a/V8+ASOMvVHM2egZAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;sent cert&quot;
        title=&quot;sent cert&quot;
        src=&quot;/static/bc7bdecc79a5adc7a42f6ace2f671b65/f058b/yt2.png&quot;
        srcset=&quot;/static/bc7bdecc79a5adc7a42f6ace2f671b65/c26ae/yt2.png 158w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/6bdcf/yt2.png 315w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/f058b/yt2.png 630w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/37523/yt2.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Let’s say we would like to make a connection to youtube.com. As we request to connect to their website, they will first send over their own certificate (that is signed by some CA). Then they will also send over the root CA that signed their certificate (the certificate that vouches that they are who they claim to be).&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVQoz42QPUvDUBSG85P0D+gfqcVJxEUXcSg4iLtDx+Igkg4WB60fKA7VQRAySG0Fo0PTpHhj89E0yb1J7jn3SowfBcH6TOcceDjvOYr8IkOBQkghPnuB8heICACIyDmXUipBgupjtKMFGy3PZblQ6GLCEQDovEEUCik55wBQzBUj4Asnw+ULZ+XSJQGlUchYQmlMDC2OxnklpX92NJqfMdaW9hqN3VqtWq2qqpplmUJiqNx4q1du+dQdUszjfqxOqYMIRcPt16R5mNxrL73eQ7vd6XS63S4AKEVCh/K2NXL8wCbEtm3DMMIwktPIZZowx3EET5OEEULMfj/LUkSYOFpIAIH5q77J5eS4QeZmw4N9P+MpY/V6vVQq60+6ZVm6rpum+dfmTLsLt9bH55shc4FD6/p2u7JInpueHw8GJiFkSmwpUYjoJ2DqScHkP3gHojDzaCBGi5EAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;check trust&quot;
        title=&quot;check trust&quot;
        src=&quot;/static/3b0e6d20057c58b0584fe9cbe5d90486/f058b/yt3.png&quot;
        srcset=&quot;/static/3b0e6d20057c58b0584fe9cbe5d90486/c26ae/yt3.png 158w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/6bdcf/yt3.png 315w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/f058b/yt3.png 630w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/37523/yt3.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The browser will first verify the signature using the crypt32 library provided by Windows. Then the same library will check against an internal registry that contains many predefined trusted root CA’s, that the CA certificate youtube.com sent us is from someone whom Windows trusts.&lt;/p&gt;
&lt;p&gt;If all verifications go well, a secure connection is established and for future requests, crypt32 in Windows will cache the sent root CA so that it can speed up subsequent requests.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVQY05WPz2rCQBDGfa0+Qd/Cd0gvKfTgvaeSSyFe2lM9SCj0UKFQemkJCipCQdEqiiQpkVSyrrvZ3ZkpS9KePOjHdxiY7zd/avQnZVABnaQaEb0uxXWP1Ts/j7M9ERm0DQP4H0IpzOdILhdCFlIIxhgAVPDtIG88zW+ev96nG6W2vOBcsmTV5ftMyN2OdB6+bc/Pvq+c5t190/c9zwuCoII/5vkwnPZfwvFwQkSAYK05oLEFIQiuRwOM1mmWxXGcJEmaphUMSi/G0YXjupeu1qq89NifbRbgodVu+Q4V0WEY0fogXA4gw47cWcK/6OiI9iMIqXIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;cache cert&quot;
        title=&quot;cache cert&quot;
        src=&quot;/static/1e37ccf6419275189394543bc871656c/f058b/yt4.png&quot;
        srcset=&quot;/static/1e37ccf6419275189394543bc871656c/c26ae/yt4.png 158w,
/static/1e37ccf6419275189394543bc871656c/6bdcf/yt4.png 315w,
/static/1e37ccf6419275189394543bc871656c/f058b/yt4.png 630w,
/static/1e37ccf6419275189394543bc871656c/37523/yt4.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;It is here, after caching, that a vulnerability exists that lets an attacker produce a malicious CA certificate that in turn will be trusted by Windows.&lt;/p&gt;
&lt;h2&gt;The Vulnerability&lt;/h2&gt;
&lt;p&gt;If we investigate how crypt32 in Windows verifies CA certificates in its cache, it goes through all cached certificates and checks if the public key in the provided CA certificate matches any of the cached CA certificates public key.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 81.64556962025317%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyUlEQVQoz3XSSW/TQBQAYH4Tv4QTy6kSF66V4MQRCXGAA4dKqCwSaiVahFBbUkpaJ03aOItdx3ZiN3EWu/bEdpLWnsRJHDuxx4OyqFCWp7nMm/dJb+bNLYxxGISGbupAn/gTFKKpH6AQ4XlEUYQxtmzLtE3H70+m3jScTMNJhGf5WxjjtnxVo5VGUS0QjMzrFyVDE82pHyw8dGG5W1pf+/Dq2euCQouXFd7gusPODIcBanLAOL/6urF79979jTfvDbFTo9QhdBdYtdUyLK+9WL9z+8Hzl0+qVzytnTWt5hyHSCnpLaGb2Ms8erhysrWqi6DOtIa9JW71ANfmcs3846ere5srUid3pvPKAiMU1RiFIlgx1wBkWT9lL1LiBSV3TVvVVKACDWpJIXFSyQhqXqqTgpjhKyeyLc9whKIq3cwfMtk4zR6XC/FiPV+XGTCwRyEKojACUCNKRJw5TPLJY5YgxRQLzm5g8oCiE1zhiCkQRS5TaRbB9Z1BD8TZOMESST5BcMSxkKZUWoFzjCNcpRXyoCglhPoBU01L1YJaozTX8RbYcPTv3I8TIcnyR5ScpQCdU/MKVJaj8gZu34SDNnQMu2/CnmH3OzCKlqOeBn4Htrq9VsfWjNkChqWOfXeBUfc8IWW2L852dW7f4GJW5RCbeTS2F3jUaMjfYlJsv51KBSw3YYs+RU00bYlh/bTFxACzD6tJX836ajZs5dDYnv8uDHk+9+5t+fO2c5p2s6Sby47SKa8mLdv+Xyz+5lCS6js7E4aZFpkxVXBpapQlfUVe4mheFYYhhD0Ie47jjH3f8/2e0+8PBo7jDC3L6V7apuk5feR5oetGQfALY4zH4zHDMFVJEnleEcRWpcplSJ7MsscpIMtmt1MWBGcwuK7/q+15dtruWFtfLj9+GhAp54CwNrc9qTE7RWhZ808c/RazLULRzfjjUX4CrPhT5nFeoH8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;compare certificates&quot;
        title=&quot;compare certificates&quot;
        src=&quot;/static/adb8baa49ea215d570fedddd24959dc4/f058b/compare-cert.png&quot;
        srcset=&quot;/static/adb8baa49ea215d570fedddd24959dc4/c26ae/compare-cert.png 158w,
/static/adb8baa49ea215d570fedddd24959dc4/6bdcf/compare-cert.png 315w,
/static/adb8baa49ea215d570fedddd24959dc4/f058b/compare-cert.png 630w,
/static/adb8baa49ea215d570fedddd24959dc4/30d16/compare-cert.png 672w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;What it on the other hand doesn’t do is verifying that both certificates are using the same type of curve. If we manage to guess the curve and the private key, we can successfully produce a fake CA certificate that we can use to sign other certificates and it is game over.&lt;/p&gt;
&lt;p&gt;But before we can produce a fake CA certificate we need to know a bit more about Elliptic Curve cryptology.&lt;/p&gt;
&lt;h2&gt;Elliptic Curve Basics&lt;/h2&gt;
&lt;p&gt;So, what is Elliptic curve cryptography, or ECC for short? It a type of cryptology in a category called asymmetric cryptology. In asymmetric cryptology you have a Public Key and Private Key. The public key can be exposed publicly, and anyone can use it to encrypt things. But the private key is the only thing that can decrypt whatever was encrypted with that particular public key.&lt;/p&gt;
&lt;p&gt;It’s very common that you share and store the public key widely across the Internet so that if someone needs to communicate encrypted with you, they can use your public key and then only you with the matching private key will be able to decrypt the message (Quite good right?).&lt;/p&gt;
&lt;p&gt;Well we talked a bit before about a set of predefined elliptic curves that you can choose from when generating a CA certificate. These curves are built up by a set of predefined values called P, a, b etc. If we define these values in a specific formula, we get an elliptic curve.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAESklEQVQ4y4VV208cVRz+zVKpcr8vLFYEloWdMwMKiSG10tQuy54DmGJpcaUVand3ZvZy5rLLNSlpWq2JRpOWl7ahNUaJ9QXZPUMpFaOJD9r4om8++9o/AjOX3dLE6Em+ZHLmzDe/75zv9x2A/xiyqnOSqoOk6p0S1dokqoEFAReAJybwhHE8YYAwa0WEtSDCnicQcQFEnIf+yDYgYkJU+phLGQYkjZxPonq9rBqQoLrzHltEBQtlCDNRwHnOmrOHP3LTXeAgSHYAkR3wvvUEUkYOZG3ZK1GjWlazEM9k7Z/xxOScKs0AT1iT++wQHiZDrhxEdioGJrerYuoKXL06V5/U1Jr1T0Mwp6wCIoxD9hrmRYT1WLKLP3AII3mbjLerMz0Is16BmAFxnPX0hPf84dnbQx8kV2tPnr8PvpEn4JDtVCNiisF39p99b+3h0NjWof2wq0QIF5qsj/yjPwLAATc6e0ccntocDoT3fAMT+RedAzBFkbAywToU8kwhtJ/5xT41l7AFYdZhvySm53T0nueCcg3W1i41xNO52u7QfrNIWB8i7NU+vM2hIpkLeyg0DSemv/IE8UMQCOsVxwsVPeF9wLProOg5Lp3NgqwttSqaWnNqZsOuui+yCxB8CiPn7sM366J9UJadEhkVIK0rMKesWNIgGNntgpoDbib2EaT1FCQyFBQ9C6nsQnOCGlXGQgIO/gC4+/kwpPU0SFQHWdVslAhjaeOonovVnY7ebXhj6jvh0UbTkfnkcoVMtZdkVa9IpOkLST3bIVHdK1O13J7/F0hUa0xk1DKIZ/T6lJYKno/dCISid0YWl+bb4plch6zqr9igmk/RjEFZ1XlZ1dpL88/jmEQ1IZ5Rj0JSS8F8chkODgACoz90Pt5sgvnkCiQ1astQNMOS3JigRkVSUyG7GAM9J4FiS9VLsNbGLckSpUAu3vR0hn6GflLoG5zcqix77W+4KF/hFM3gUtkFUPTF1svphbrR929D1dBf0PLm7zCXXOVm4te5jJGy9pKTqMbFMxTA++5vtm0c6zAvwuyYYwPTE4pueJZWZVhcUZqurU1X1A7/WT5AtptFXGjgsQm8613esZljm8HIlt1qXZOm2wGmyBOz0nruDu3DxNwtOHPpi+7jZ78e6h3bDYiEtQuYdSLM+MDY9xxfJMTMLsrt5WIc7QA//rCcJ6aACPOL4wV/ILznP/XeveP4wi2f5cNA+LGzHhcaecIEHuehHW8Cwiag8WIvO81dIhUj21w/zle/PrFVDb1Pj1xZ+7BhaXm+8pPrU3Dy3JdWTHFuN/kQYV1uUHClbmme/smpziUVI3k7G1tP/ApnL38GkrbcGs9ka2TNyUPeCQMncTALIsJqS71cHMNvP7ArDbrE/TgP0cQNjuZUK2DbJKrXFQNWwA8OR145wkwQyCPoHfsW4P+uANdnfolq7cUroJhMAi5wrkNeFjGrt1T9AziN0F6XhB1LAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;elliptic curve example&quot;
        title=&quot;elliptic curve example&quot;
        src=&quot;/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png&quot;
        srcset=&quot;/static/ba395866b6facbfd04e1490275a99d60/c26ae/curve.png 158w,
/static/ba395866b6facbfd04e1490275a99d60/6bdcf/curve.png 315w,
/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png 400w&quot;
        sizes=&quot;(max-width: 400px) 100vw, 400px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To start generating a public and private key from this curve we first need to define a starting point on the curve, we can call this starting point G (the generator). From this starting point we then start jumping around on the graph “n” number of times.&lt;/p&gt;
&lt;div style=&quot;display: flex; justify-content: center;&quot;&gt;
  &lt;div style=&quot;width: 400px; 
  margin: 0 1rem;
    margin-bottom : 1.5rem;&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; &quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChUlEQVQ4y4VUW1PaUBDmj/aPdPrSp9bpU1/70OnUTiszjgVtUVTEIGCRi0FChUguhxCSSK4kJBCSsx2Iw6WK7sNO9pz9zpfZ3W9j8JRhjAGApmlZlhdhdAGLb4DYM2Ce5zVdX4RhOPOe2J8MBlHSc2COR4ZhrDKHvm+UStj3n2aO8iIvCkhVtXbfITljYHkX7HB7v+xL0iIh9h8UAALLROi+zg9/ZhuHpJgi709ulJrk1evCp50vg8CeJT5mxhgPqaZNkjKvfL/8++rNR7FMRjdTWweqmenkKj3qEfM8sCnKRSg6UMbK+/QxdUlBs1EgsrWLcwggw5caMr0Eh2GIwxAAprZt1mqzqgRTHOBruXlUOU1cCQBAMKUUWwSA406+IbXnlZ9ZbEHrIeSvdLXYJ3NUroU0qu8jSzhhZuAs/6elsktmmqZ5jutK0h1BsI0G6vUQ4hGPErX013ScbbeS+U6iWowXE7Igxa8OiHqxL4gsyzIME5MkSVNV03HEcvme4wzL0nVdU7XTVn43l5SEnqo5Hw7Pf92cOqZzfJsTFNEyLVVVZVle+W1BGPd6D0XHkO9V0teZ0dABgHSn/aNOAEBBqFrj4bJVi+kJPM+sVqNiAAbW6J7UzkaOCwCNDrmVObNcuBQq5gN4xrDWKoemnXY7eowyue3CXidfS+5k38Ur2X3iW6qdYav2ZMOQRHiTJN1W64w4eLv7+/PedeHOsH3A3ugwUdrKpMYPE7ZpPF13oqng+izbVXRz0RhvNH29nzQnzkbmSLFRNkIrqsIwhZC9bblI2CCMdW2hbtcwl8wYcBBMzaty4HkvLwOO4zRNW+p57ieq6s8PX1gGDMMoirK2htbtH9mqX7QtoBmCAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image&quot; alt=&quot;elliptic curve movement&quot; title=&quot;elliptic curve movement&quot; src=&quot;/static/6466c7be20c67da3cba29658b490f37b/13ae7/elliptic-curve-movement.png&quot; srcset=&quot;/static/6466c7be20c67da3cba29658b490f37b/c26ae/elliptic-curve-movement.png 158w,
/static/6466c7be20c67da3cba29658b490f37b/6bdcf/elliptic-curve-movement.png 315w,
/static/6466c7be20c67da3cba29658b490f37b/13ae7/elliptic-curve-movement.png 350w&quot; sizes=&quot;(max-width: 350px) 100vw, 350px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot;&gt;
    &lt;/span&gt;
  &lt;/div&gt;
  &lt;div style=&quot;width: 400px; 
  margin: 0 1rem;
    margin-bottom : 1.5rem;&quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; &quot;&gt;
      &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtElEQVQ4y01SiZLrOAj0/3/jmz0mk3mJLVsSh5A4nC05U7tLUTY2Qt00LOu2FSD+nxELMyNSI9rScVRujRszkFT890zLwMu6rsPcIs7zjAiL8IgzQv0klm3bxjt3nuYhNkP1OF8vbm1JKZmZu0e4+fS3mTlx2/ddzdVd1NWiDTOP6XES87Jt2yyOeJepzTI1D3duLaXk7sNimKPYMO/qIGZxMvMPsprL+AHW+Tnjq3jrajupqEdEv1i0Ya/XaxbnnFUtIvwqHfbDOSLaf8iTy0TWiVwv5NZ4OY5D9UJye9sb/+pZjn0fOtnKmFdcPV+t+Ul0IYu6/4gd6lPtKzi5SUpp2ExGnB6nTOXjrXZrbdn3vVzjI2IkRsRSEYkqACGmo2wZ3rMtQLkiciMiJE65LiKti7T2XgSutcJltRYmEpk5pmlMhIg0YZAIAXHJpR7ALB1Y5q1t9N5bE2QhGRXwAM4oxFKoF2qV2g6SoFGTZUtpLyjq0EYf2odR1yeMHeeSllr/epZbHh9J7rl/5b7CuGX5SPLMtJRSmNnjNHfqzt1E7YwYw5AZAf58loP9K48NxxP0XkZpeivjvtOCiBlIPVD08msYPokgNwS4bfBddUXdyWrTB4yd7Ak9V1wAptSv16nmZ4Sof1ctzVpXmvrBr0ep4rnZRxr3MkB8BU00gGiptRQgj5MmYadu3K0NJ1G+kD+3+gBbUb+r7qQH24rjAb0ALXMsOGl3naxQ1Nxfr2h9ADEh/L3WnW1KSJpZv3KvYo/aHxmXOVhki1dX7xZ9gnsRr03n/Jn/eNbfGL/SeIDeqz7Bnmgf+/jOvFSgx16oSapckZHnvqRCKUOlJn3c1nzf6Xng78z3HbeCnxt8bpAKLGMMQKxzpa4H4HyXkvNRah1jcGuIc1WPXMr8n4/jOHJet/QPS6R+OTdYN5UAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&quot;gatsby-resp-image-image&quot; alt=&quot;elliptic curve dots&quot; title=&quot;elliptic curve dots&quot; src=&quot;/static/8c19bb8190d069c2b57e9acdc3cd8307/13ae7/elliptic-curve-dots.png&quot; srcset=&quot;/static/8c19bb8190d069c2b57e9acdc3cd8307/c26ae/elliptic-curve-dots.png 158w,
/static/8c19bb8190d069c2b57e9acdc3cd8307/6bdcf/elliptic-curve-dots.png 315w,
/static/8c19bb8190d069c2b57e9acdc3cd8307/13ae7/elliptic-curve-dots.png 350w&quot; sizes=&quot;(max-width: 350px) 100vw, 350px&quot; style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot;&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
I’m not going to explain how we jump around on the curve because it’s quite complicated and there is an entire wiki page describing just this so we will leave that out for now. But what you should know is that by jumping around millions, or even billions of times on the curve will result in a series of dots (when you remove the curve) and this will end up as a very large factor. Let’s call this factor “x”. In the end we end up with a simple formula x * G (starting point multiplied by our factor).
&lt;p&gt;This formula will be equal something so let’s add that to, so we end up with something like:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVQoz4WRv6uDMBDH/f8HR5dOxbWlIKWldJOCIi4i0hJiobr4KxgwikiSK8+8F2wd3me63N0398uAGSkln5FSwh/KFkJwzgFgnWDACjmjZMvUNYYKj+N4OByOx6MqopSMMQDI89zzPAA4n8+Xy0Un/IiFEAAQBMHtdnNdN47jMAz3+70QwrIs3/cZYwihJElOp9Nut3s+n3qi38pFUdi2bZpm0zRRFF2vV875drv1fV8VIYQ4jrPZbD7E2iKElGWpGgGAvu8ppYwxKaVytjMfM+sltW1b17XeVlVVj8cjz3OlFEKo36dp+l5Y13UIIYwxpVQFiqLAGL9er2EY1PN+v6dpmmWZPoEB/7G8lh7qW6wbXj61Ry7Q4jeMLTdYNn7CgwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;curve equation&quot;
        title=&quot;curve equation&quot;
        src=&quot;/static/6556231d00d61215e279756f6bd5dd23/f058b/maff1.png&quot;
        srcset=&quot;/static/6556231d00d61215e279756f6bd5dd23/c26ae/maff1.png 158w,
/static/6556231d00d61215e279756f6bd5dd23/6bdcf/maff1.png 315w,
/static/6556231d00d61215e279756f6bd5dd23/f058b/maff1.png 630w,
/static/6556231d00d61215e279756f6bd5dd23/37523/maff1.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Where G is our starting point on the graph, x is the result of us jumping around, and the product is Q.&lt;/p&gt;
&lt;p&gt;When defined, x in this formula is our private key and Q our public key. And as mentioned before our public key we can send to anyone, but how we got the result (x and G) is our “secret sauce” that no one can know anything about.&lt;/p&gt;
&lt;p&gt;Trying to derive the key by flipping the formula is what is known as the Discrete Logarithm Problem and is known to be a very difficult problem so that is not a possibility when trying to reverse engineer the private key.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABK0lEQVQY012QTU/CQBiE+bPGs+GqVyLeSAjBExEvoqUBSiURgdhIQ/1GpZiKSAWhtJFEo6Tt7r6vaWtqdU6zmzyzOxNDRHAdMhyQxRugJ4boGQhOnn4dIrNM8qIHPubDLhkOoN9zO22q3uF8hpQyAPnqWrnpAiJZLJZqz2w16snEpNVAcw5+dCzIcAkpCYKmabZpKnzROD4a5HPtdKqVTBil4j3PTS7ORY6rCEK92fS/FYERcS0elyVpetvd3lif1sThwd7h1mZmdWVc5s92csunx8pufr9QyGSzIeLDlHz1e3q1bNSq7EEFY+Z1Y+xSVU86ytK2Py0T9ZF1Ksnp1LMosOlrpLPjUH0Ejh3O82+wP/p4p5Nx5OWQAfAYxoIb6uunIWPAqLdjJOcbr+t7juqIZRAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;discrete logarithmic problem&quot;
        title=&quot;discrete logarithmic problem&quot;
        src=&quot;/static/8e266866b39ac710d2ebd6fa24063a37/f058b/maff2.png&quot;
        srcset=&quot;/static/8e266866b39ac710d2ebd6fa24063a37/c26ae/maff2.png 158w,
/static/8e266866b39ac710d2ebd6fa24063a37/6bdcf/maff2.png 315w,
/static/8e266866b39ac710d2ebd6fa24063a37/f058b/maff2.png 630w,
/static/8e266866b39ac710d2ebd6fa24063a37/37523/maff2.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So, for the time being this feels pretty secure, right?&lt;/p&gt;
&lt;h2&gt;CVE 2020–0601&lt;/h2&gt;
&lt;p&gt;With this knowledge as a prerequisite this is where CVE 2020–0601 comes into play. Since Windows does not verify the curve provided in the certificates, we can provide these parameters and create a malicious certificate based on this simple math.&lt;/p&gt;
&lt;p&gt;Since we can control the parameters, how about we set the private key to something like 20, or 100 or just something simple…. like the number 1?&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 20.253164556962027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQI1zWOwYqFIBhGe/+3CDetg0ubIChs2yIoiStUEGSUmYUapv8ME3NWHxw+OAFjrG1b7z0AWGuFENd17fs+z/MwDPAPIWRd13cvy/KqoCgKhNA4jmVZLsuSZZkQou/7PM+jKFJKAQDnHCGEMe66jhCCMQ7DUCkVUErjON62ra7r8zynabLWAkDTNGma3vcNAM/zJElSVRWl9PvH5/PRWgfGmOM4tNYAIKVkjCmlnHPbtkkpjTFvqlJKCOGc895zzqWUv+cf3N/XbjaIlsEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;breaking the maths&quot;
        title=&quot;breaking the maths&quot;
        src=&quot;/static/da65fd3694e426caa381884c16026b00/f058b/maff3.png&quot;
        srcset=&quot;/static/da65fd3694e426caa381884c16026b00/c26ae/maff3.png 158w,
/static/da65fd3694e426caa381884c16026b00/6bdcf/maff3.png 315w,
/static/da65fd3694e426caa381884c16026b00/f058b/maff3.png 630w,
/static/da65fd3694e426caa381884c16026b00/37523/maff3.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This will result in our public key being equal to our starting point on the graph, and just like that we have the two secrets parameters, just from knowing the public key!&lt;/p&gt;
&lt;p&gt;With all this information we can now forge any Elliptic Curve certificate just by acquiring the public key. Here’s an example. We acquire a public key say 1234 and we put this into our formula:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 30.37974683544304%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY04WQsYqFMBRE3/9XfoIIai0INmJSiFpYWYhVwEIMEo0aiTGJ+nCzWC3slHfmwJ353H/p+tH9nz5KKcYYpRRjvG0b51wpZTzGmNaaUiqE4JzP8zwMwziOx3EIIR54HMcwDOM4dhzH933LsggheZ4TQgAAXdfVdb2uKwAgiiLP82zbdl03TdMHllI2TQMhLMsSABAEwTRNWZb1fY8xnufZfNG2LYSwKAoAQJIkVVU9sPGWZUEIUUpN4fu+hRB93w/DcJ6nyazrihDquu69/MJaayGElNIY13Vprfd9N93ezL7vx3G8o3wBYfZK/RCGiVsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;breaking the maths&quot;
        title=&quot;breaking the maths&quot;
        src=&quot;/static/12c29d0d2048c2dcdeee4639af6b980e/f058b/maff4.png&quot;
        srcset=&quot;/static/12c29d0d2048c2dcdeee4639af6b980e/c26ae/maff4.png 158w,
/static/12c29d0d2048c2dcdeee4639af6b980e/6bdcf/maff4.png 315w,
/static/12c29d0d2048c2dcdeee4639af6b980e/f058b/maff4.png 630w,
/static/12c29d0d2048c2dcdeee4639af6b980e/37523/maff4.png 720w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And by using this information, we can then generate a valid CA certificate that we control!&lt;/p&gt;
&lt;p&gt;So to recap:&lt;/p&gt;
&lt;p&gt;Just by acquiring the public key from any source we can then generate a fully valid malicious CA certificate that we can use to sign any other certificate. This certificate will then be trusted by Windows 10 because it will pass the check against it’s certificate cache.&lt;/p&gt;
&lt;h2&gt;Ollypwn’s Proof Of Concept&lt;/h2&gt;
&lt;p&gt;Oliver Lyak demonstrates this in a Github repository how to exploit the vulnerability by generating a false CA certificate and then proceeds to demonstrate how it can be used to sign other certificates, or sign code as “trusted”.&lt;/p&gt;
&lt;p&gt;The code below is taken from his example.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; ‘openssl’

&lt;span class=&quot;token comment&quot;&gt;# Read file provided in the first argument&lt;/span&gt;
raw &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read &lt;span class=&quot;token constant&quot;&gt;ARGV&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Parse the file as a certificate&lt;/span&gt;
ca &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OpenSSL&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;X509&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Certificate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;raw&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Extract the public keyca_key = ca.public_key# Set a private key to 1&lt;/span&gt;
ca_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;private_key &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Get the group parameters that contains the curve&lt;/span&gt;
group &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ca_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;group

&lt;span class=&quot;token comment&quot;&gt;# Set the generator parameters (G in our formula) to the public key&lt;/span&gt;
group&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;set_generator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ca_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;public_key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cofactor&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Ensure we are sending explicit parameters and not a predefined curve&lt;/span&gt;
group&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asn1_flag &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OpenSSL&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;PKey&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;EC&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;EXPLICIT_CURVE&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Set our new group with our fake generator G’ = Q&lt;/span&gt;
ca_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;group &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; group

&lt;span class=&quot;token comment&quot;&gt;# Save this to a file as our new CA&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;open&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;“spoofed_ca&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;key”&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ‘w’&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;f&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; f&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write ca_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_pem &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It first reads in a predefined CA certificate, for example the MicrosoftECCProductRootCertificateAuthority.cer which is the official certificate Microsoft uses to sign many things with.&lt;/p&gt;
&lt;p&gt;Then it reads out the public key from it and then defines at sets some new custom parameters, generator etc. We can see that the code explicitly sets the private key to 1 and then save it to a new spoofed CA certificate that can be used to sign code or other certificates.&lt;/p&gt;
&lt;p&gt;This newly generated certificate can be used to act like microsoft and sign other certificates. We essentially can claim that we are Microsoft and vouch for anyone. Extremely powerful.&lt;/p&gt;
&lt;p&gt;Ollypwn then continues to demonstrate how to sign some code as “trusted by Microsoft” and also how to generate a website certificate claiming to be issued by &lt;a href=&quot;http://www.google.com&quot;&gt;www.google.com&lt;/a&gt; and then sign this certificate with the crafted “Microsoft” certificate.&lt;/p&gt;
&lt;p&gt;What this all boils down to is that by exploiting CVE 2020–0601 we can claim that we are anyone, and we can vouch for anyone on the internet.&lt;/p&gt;
&lt;p&gt;This in turn can be used to pass firewalls, push fake updates containing malware to any Windows 10 machine claiming we are “Microsoft”. We can for example set up fake websites claiming that we are any of the big companies and we can also develop malicious programs that windows 10 just blindly will trust as “safe software”.&lt;/p&gt;
&lt;p&gt;The possibilities are endless, only creativity will stop you and the hackers out there.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 438px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1UlEQVQoz6WTXUxSYRjHvei+i+7qoptq68L8qFGDJepamiH4sVBpNnRM5so0W+YQS6ZzJKSt8qsPy+a3nkMgR7EwDUshKsSAzNDCUkTDw5dKk3Pedg7m1K2r/nsv3r3b73me7f09IeAfwXEcI7N5CSYQCAQfAQAh4D+yDcYBwHCwjhFVbTab+qUaQRCz2azRaORyuUqlMhgMEAQplYj1q5WAMZwAyCk2gmEYAMBisQy9ftWLKMxm8/DwcFdXd39fv17//nHTo26o02QybeuMA4CuYVZ0ffTn6ot50KsakxbW2Wd+2b7bILinrr62o6NtZmba7Vi5L2yWd/QRsOaHv97gKR1Bn5l8WX1LDMhBb52Pk7laBrSU3akn9rCoFFpaApeXUsBh8E5So6l7GUd2sbo7ZQR8We2ktdij2+1VOlcSvBjf5WD0LJyFUfOCm8c+c2hfhCCzWpL15Da3Wcp9WsFriDhApYTTl9FlAi4dQRMhBwt23P3gzuhdSoIdTNjJk5tm9bmfumgKSUbRaXF5Yr2Y/aAypVGYUMMOy2Mncci/BCFNE16hBi1741JYV2v0boluWaxfR8ba13THSrj0oXrmdTaTEZbVmNd+ISY3MTSdH1oWE8p0ecnOQg3K6HGwILKzYikZtsdCfniw0jsS6dTFerQMaXbJwf1hnWIk/PDRK8xSQdS9hMh0tw8l4PxBJ63VHtVmv6V1JcEL9G5fheL5IhKDjl+dRDgNXL4gtbq8QKJu0kmLa0XZ0txw0bWcm8TYGB4yOud/aPSK3qLtFk/2gE8gU07K4gRtHVYPcNjn0iiFuceFOefy+JkX+ZxLBafKzkfkG40TQR22GIZjngDwflPaptR9s8C54gcAWKemRdw7RfFVxcliQaL0RnrNR52RJPENwwLk2SoZqQwI2u//7f9stGpV46Z3X3w+36aCO90mPcVwHCNq/VUVx/Adq7a5GH8A3SWwCZSuEmQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;summary&quot;
        title=&quot;summary&quot;
        src=&quot;/static/42fc74204812244be63f4b6dcd477123/50e4b/summary.png&quot;
        srcset=&quot;/static/42fc74204812244be63f4b6dcd477123/c26ae/summary.png 158w,
/static/42fc74204812244be63f4b6dcd477123/6bdcf/summary.png 315w,
/static/42fc74204812244be63f4b6dcd477123/50e4b/summary.png 438w&quot;
        sizes=&quot;(max-width: 438px) 100vw, 438px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;This has been a high-level breakdown of CVE 2020–0601 in the Microsoft crypto API that got disclosed to the world on the 14th of January 2020. This text has tried to demonstrate how a simple miss in validation can have a huge impact on the security of the Internet.&lt;/p&gt;
&lt;p&gt;This post has also tried to show how this vulnerability can be exploited to generate malicious CA certificates, that in turn can be used to circumvent a lot of security features, like firewalls, website traffic etc.&lt;/p&gt;
&lt;p&gt;Final last words are, always patch your systems… Always&lt;/p&gt;
&lt;h2&gt;Appendix&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0601&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0601&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601&quot;&gt;https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://krebsonsecurity.com/2020/01/cryptic-rumblings-ahead-of-first-2020-patch-tuesday/&quot;&gt;https://krebsonsecurity.com/2020/01/cryptic-rumblings-ahead-of-first-2020-patch-tuesday/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/saleemrash1d/status/1217495681230954506&quot;&gt;https://twitter.com/saleemrash1d/status/1217495681230954506&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ollypwn/CurveBall&quot;&gt;https://github.com/ollypwn/CurveBall&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.secg.org/SEC2-Ver-1.0.pdf&quot;&gt;https://www.secg.org/SEC2-Ver-1.0.pdf&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Hello World]]></title><description><![CDATA[This is my first post on my new fake blog! How exciting! I’m sure I’ll write a lot more interesting things in the future. Oh, and here’s a…]]></description><link>https://blog.toerktumlare.com/hello-world/</link><guid isPermaLink="false">https://blog.toerktumlare.com/hello-world/</guid><pubDate>Fri, 01 May 2015 22:12:03 GMT</pubDate><content:encoded>&lt;p&gt;This is my first post on my new fake blog! How exciting!&lt;/p&gt;
&lt;p&gt;I’m sure I’ll write a lot more interesting things in the future.&lt;/p&gt;
&lt;p&gt;Oh, and here’s a great quote from this Wikipedia on
&lt;a href=&quot;https://en.wikipedia.org/wiki/Salted_duck_egg&quot;&gt;salted duck eggs&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A salted duck egg is a Chinese preserved food product made by soaking duck
eggs in brine, or packing each egg in damp, salted charcoal. In Asian
supermarkets, these eggs are sometimes sold covered in a thick layer of salted
charcoal paste. The eggs may also be sold with the salted paste removed,
wrapped in plastic, and vacuum packed. From the salt curing process, the
salted duck eggs have a briny aroma, a gelatin-like egg white and a
firm-textured, round yolk that is bright orange-red in color.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8058f3f26913fea3b6a89a73344fe94a/e1596/salty_egg.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMB/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAEEBf/aAAwDAQACEAMQAAABgik0dWC//8QAGRABAAMBAQAAAAAAAAAAAAAAAQACERJC/9oACAEBAAEFAkqW7B5Zovtvk//EABcRAQADAAAAAAAAAAAAAAAAAAAREkH/2gAIAQMBAT8B1WX/xAAWEQEBAQAAAAAAAAAAAAAAAAAAESL/2gAIAQIBAT8BjT//xAAbEAABBAMAAAAAAAAAAAAAAAAAAQIRISIxMv/aAAgBAQAGPwK9GNocyS8hCj//xAAaEAADAQEBAQAAAAAAAAAAAAAAAREhQYGx/9oACAEBAAE/IXOrA43oOyg9wgU86OZMfwZKypT/2gAMAwEAAgADAAAAEMjv/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAwEBPxARwyusv//EABcRAQEBAQAAAAAAAAAAAAAAAAEAIVH/2gAIAQIBAT8QOoVoX//EAB0QAQEAAgIDAQAAAAAAAAAAAAERADFhgSFB0eH/2gAIAQEAAT8QSpwaGjrBSrtHyF9iY8RpUnGRBGqtOcsiDE6fM3AgiXf5M//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Chinese Salty Egg&quot;
        title=&quot;Chinese Salty Egg&quot;
        src=&quot;/static/8058f3f26913fea3b6a89a73344fe94a/828fb/salty_egg.jpg&quot;
        srcset=&quot;/static/8058f3f26913fea3b6a89a73344fe94a/ff44c/salty_egg.jpg 158w,
/static/8058f3f26913fea3b6a89a73344fe94a/a6688/salty_egg.jpg 315w,
/static/8058f3f26913fea3b6a89a73344fe94a/828fb/salty_egg.jpg 630w,
/static/8058f3f26913fea3b6a89a73344fe94a/0ede0/salty_egg.jpg 945w,
/static/8058f3f26913fea3b6a89a73344fe94a/3ac88/salty_egg.jpg 1260w,
/static/8058f3f26913fea3b6a89a73344fe94a/e1596/salty_egg.jpg 2048w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;You can also write code blocks here!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; saltyDuckEgg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;chinese preserved food product&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;left&quot;&gt;Number&lt;/th&gt;
&lt;th align=&quot;left&quot;&gt;Title&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Year&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Harry Potter and the Philosopher’s Stone&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;2001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;2&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Harry Potter and the Chamber of Secrets&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;2002&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;left&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;left&quot;&gt;Harry Potter and the Prisoner of Azkaban&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;2004&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;a href=&quot;https://raw.github.com/adamschwartz/github-markdown-kitchen-sink/master/README.md&quot;&gt;View raw (TEST.md)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This is a paragraph.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;This is a paragraph.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Header 1&lt;/h1&gt;
&lt;h2&gt;Header 2&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Header 1
========

Header 2
--------&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Header 1&lt;/h1&gt;
&lt;h2&gt;Header 2&lt;/h2&gt;
&lt;h3&gt;Header 3&lt;/h3&gt;
&lt;h4&gt;Header 4&lt;/h4&gt;
&lt;h5&gt;Header 5&lt;/h5&gt;
&lt;h6&gt;Header 6&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# Header 1
## Header 2
### Header 3
#### Header 4
##### Header 5
###### Header 6&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;Header 1&lt;/h1&gt;
&lt;h2&gt;Header 2&lt;/h2&gt;
&lt;h3&gt;Header 3&lt;/h3&gt;
&lt;h4&gt;Header 4&lt;/h4&gt;
&lt;h5&gt;Header 5&lt;/h5&gt;
&lt;h6&gt;Header 6&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# Header 1 #
## Header 2 ##
### Header 3 ###
#### Header 4 ####
##### Header 5 #####
###### Header 6 ######&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&gt; Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;h2&gt;This is a header.&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;This is the first list item.&lt;/li&gt;
&lt;li&gt;This is the second list item.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Here’s some example code:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Markdown.generate();&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&gt; ## This is a header.
&gt; 1. This is the first list item.
&gt; 2. This is the second list item.
&gt;
&gt; Here&apos;s some example code:
&gt;
&gt;     Markdown.generate();&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Red&lt;/li&gt;
&lt;li&gt;Green&lt;/li&gt;
&lt;li&gt;Blue&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;Red&lt;/li&gt;
&lt;li&gt;Green&lt;/li&gt;
&lt;li&gt;Blue&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;Red&lt;/li&gt;
&lt;li&gt;Green&lt;/li&gt;
&lt;li&gt;Blue&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Red
&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Green
&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Blue

&lt;span class=&quot;token list punctuation&quot;&gt;*&lt;/span&gt; Red
&lt;span class=&quot;token list punctuation&quot;&gt;*&lt;/span&gt; Green
&lt;span class=&quot;token list punctuation&quot;&gt;*&lt;/span&gt; Blue

&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Red
&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Green
&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; Blue&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;code goes&lt;/code&gt; here in this line&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bold&lt;/strong&gt; goes here&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token code-snippet code keyword&quot;&gt;`code goes`&lt;/span&gt; here in this line
&lt;span class=&quot;token list punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token bold&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;bold&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;**&lt;/span&gt;&lt;/span&gt; goes here&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Some java code&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; function &lt;span class=&quot;token function&quot;&gt;helloworld&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;Buy flour and salt&lt;/li&gt;
&lt;li&gt;Mix together with water&lt;/li&gt;
&lt;li&gt;Bake&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token list punctuation&quot;&gt;1.&lt;/span&gt; Buy flour and salt
&lt;span class=&quot;token list punctuation&quot;&gt;1.&lt;/span&gt; Mix together with water
&lt;span class=&quot;token list punctuation&quot;&gt;1.&lt;/span&gt; Bake&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;code goes&lt;/code&gt; here in this line&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bold&lt;/strong&gt; goes here&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token list punctuation&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;token code-snippet code keyword&quot;&gt;`code goes`&lt;/span&gt; here in this line
&lt;span class=&quot;token list punctuation&quot;&gt;1.&lt;/span&gt; &lt;span class=&quot;token bold&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;bold&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;**&lt;/span&gt;&lt;/span&gt; goes here&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Paragraph:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Code&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- --&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Paragraph:

    Code&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;hr&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;* * *

***

*****

- - -

---------------------------------------&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is &lt;a href=&quot;http://example.com&quot; title=&quot;Example&quot;&gt;an example&lt;/a&gt; link.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://example.com&quot;&gt;This link&lt;/a&gt; has no title attr.&lt;/p&gt;
&lt;p&gt;This is &lt;a href=&quot;http://example.com&quot; title=&quot;Optional Title&quot;&gt;an example&lt;/a&gt; reference-style link.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;This is [an example](http://example.com &quot;Example&quot;) link.

[This link](http://example.com) has no title attr.

This is [an example] [id] reference-style link.

[id]: http://example.com &quot;Optional Title&quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;single asterisks&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;single underscores&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;double asterisks&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;double underscores&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;*single asterisks*

_single underscores_

**double asterisks**

__double underscores__&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This paragraph has some &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; in it.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;This paragraph has some `code` in it.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://placehold.it/200x50&quot; alt=&quot;Alt Text&quot; title=&quot;Image Title&quot;&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;![Alt Text](https://placehold.it/200x50 &quot;Image Title&quot;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item></channel></rss>